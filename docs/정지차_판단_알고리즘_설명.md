# 정지차 판단 알고리즘 설명

## 핵심 원리

**"정지한 차량이 2대 이상이면 정체, 1대만 있으면 불법주정차"**

- **정지차**: 혼자서 5초 이상 멈춰있는 차량 (불법 주정차로 판단)
- **정체**: 2대 이상의 차량이 동시에 멈춰있는 상태 (교통 정체)

---

## 판단 과정

### 1단계: 차량이 멈춰있는지 확인 (1초 관찰)

영상에서 차량의 위치를 1초 동안 추적하여 거의 움직이지 않으면 "정지 중"으로 판단합니다.

**차량 크기에 따른 자동 조정**
- 큰 차량(트럭, 버스): 더 큰 움직임까지 허용
- 작은 차량(승용차): 작은 움직임만 허용
- 이렇게 하면 차량 크기와 상관없이 정확하게 정지 여부를 판단할 수 있습니다.

### 2단계: 정지차인지 정체인지 구분 (5초 관찰)

현재 멈춰있는 차량의 개수를 세어서 판단합니다.

**분류 규칙**
- **2대 이상 멈춰있음** → 정체 상황 (주황색 박스)
  - 정지 시간 카운터를 0으로 초기화
- **1대만 멈춰있고 5초 이상 지속** → 불법 주정차 (빨간색 박스)
- **1대만 멈춰있지만 5초 미만** → 일시 정지 (초록색 박스)
  - 예: 신호 대기, 앞차 기다림 등

---

## 추가 기능

### 작은 물체 무시

화면에 너무 작게 보이는 물체는 차량이 아닐 가능성이 높으므로 감지 대상에서 제외합니다.
- 멀리 있는 차량이나 오인식된 물체를 걸러냅니다.
- 정확도를 높이고 오탐을 줄입니다.

---

## 시간 기준

| 시간 | 용도 |
|------|------|
| 1초 | 차량이 멈춰있는지 빠르게 판단 |
| 5초 | 정지차로 확정 (신호 대기 등 일시 정지와 구분) |

---

## 동작 흐름

1. **영상 분석**: CCTV 영상에서 차량을 찾아 추적
2. **작은 물체 제거**: 너무 작게 보이는 것은 무시
3. **정지 여부 확인**: 1초 동안 거의 움직이지 않으면 "정지 중"
4. **개수 세기**: 현재 멈춰있는 차량이 몇 대인지 계산
5. **최종 판단**:
   - 2대 이상 → **정체** (주황색)
   - 1대만 5초 이상 → **정지차** (빨간색)
   - 1대만 5초 미만 → 일반 차량 (초록색)

---

## 색상 의미

- **빨간색**: 불법 주정차 차량
- **주황색**: 정체 중인 차량
- **초록색**: 정상 주행 차량
